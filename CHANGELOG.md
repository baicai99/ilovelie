# 更新日志

此文件记录了"我爱撒谎"插件的所有重要变更。

格式基于 [Keep a Changelog](http://keepachangelog.com/)，
版本遵循 [语义化版本](http://semver.org/)。

## [1.1.1] - 2025-05-30

### 移除
- ❌ **删除临时还原功能**：完全移除临时还原相关的所有功能
  - 移除 `toggleTruthLieState()` 方法和 `Ctrl+Shift+T` 快捷键
  - 移除 `temporarilyRestoreAllLies()` 方法和 `Ctrl+Shift+Alt+T` 快捷键  
  - 移除 `manuallyRestoreLies()` 方法和 `Ctrl+Shift+R` 快捷键
  - 删除 `TempStateManager` 类和相关类型定义
  - 移除右键菜单和命令面板中的临时还原选项
  - 保留基础的撒谎和历史恢复功能

## [1.0.2] - 2025-05-29

### 🎉 重大新增
- ✨ **AI智能替换功能**：基于OpenAI GPT-4o-mini的智能撒谎系统
  - **单个AI替换**：选中注释后使用AI生成创意撒谎内容
  - **批量AI替换**：一键使用AI替换文件中的所有注释，支持批量优化模式
  - **选择性AI替换**：预览并选择要进行AI替换的特定注释
  - **混合处理模式**：批量失败时自动回退到单个处理，确保最高成功率
  - **智能内容清理**：自动清理AI返回内容中的注释符号，避免格式问题

### 新增
- ✨ **完整的AI配置系统**：
  - **配置中心界面**：专业的配置界面，支持API Key、Base URL、模型选择
  - **连接测试功能**：一键测试API连接是否正常
  - **多模型支持**：支持gpt-4o-mini、gpt-4o、gpt-4-turbo、gpt-3.5-turbo等模型
  - **代理支持**：支持自定义Base URL，兼容代理和其他OpenAI兼容服务
  - **配置重置**：一键重置为默认配置
- ✨ **AI费用控制**：替换前明确提示可能产生的API费用
- ✨ **进度显示**：AI处理过程中显示详细的进度信息
- ✨ **右键菜单集成**：在编辑器右键菜单中添加AI相关功能
- ✨ **历史记录支持**：AI替换的内容也会记录到历史中，支持精确还原

### 改进
- 🔧 **架构优化**：重构命令注册系统以支持AI功能
- 🔧 **错误处理**：完善的AI错误处理和用户友好的错误提示
- 🔧 **性能优化**：批量AI处理支持动态token限制，提高处理效率

## [1.0.1] - 2025-05-29

### 新增
- ✨ **隐藏注释功能**：新增注释隐藏/显示切换功能
  - **Toggle切换**：使用 `Ctrl+Shift+H` 快捷键快速切换注释显示状态
  - **智能恢复**：完美记住并恢复所有隐藏的注释
  - **文件级管理**：每个文件独立管理隐藏状态
  - **右键菜单集成**：在编辑器右键菜单中添加"切换注释显示/隐藏"选项
  - **命令面板支持**：可通过命令面板使用"切换注释显示/隐藏"命令
- ✨ **CommentHider管理器**：新增专门的注释隐藏管理模块
- ✨ **文档关闭清理**：文档关闭时自动清理隐藏状态记录

### 改进
- 🔧 **扩展架构优化**：重构命令注册系统以支持新的隐藏功能
- 🔧 **用户体验提升**：增加友好的操作提示和状态反馈

## [1.0.0] - 2025-05-29

### 🎉 重大Bug修复
- 🐛 **完全修复恢复功能**：插件现在支持完整可靠的恢复功能

### 修复
- 🐛 **精确撤销系统**：不再依赖VS Code原生撤销，实现精确的内容还原
- 🐛 **智能还原算法**：修复从历史中还原的准确性问题，支持位置变化后的智能搜索
- 🐛 **历史记录持久化**：修复重启VS Code后历史记录丢失的问题
- 🐛 修复右键菜单缺少还原功能按钮的问题

### 新增
- ✨ **历史记录持久化**：使用VS Code globalState API实现数据持久化
- ✨ **精确恢复系统**：
  - 支持精确位置还原
  - 智能搜索附近行进行还原
  - 添加唯一ID跟踪每个更改
  - 包含完整的位置信息记录
- ✨ **清除所有历史**：一键清除所有撒谎记录的功能
- ✨ **改进的撤销功能**：
  - 支持跨文件撤销提醒
  - 精确的内容匹配和还原
  - 防止误操作的确认机制
- ✨ **增强的用户体验**：友好的错误提示和确认对话框

### 改进
- 🔧 重构历史记录数据结构，包含位置信息和唯一ID
- 🔧 优化还原算法，大幅提高成功率
- 🔧 添加完善的错误处理和用户友好的提示信息
- 🔧 改进右键菜单功能布局

### 技术改进
- 📦 模块化历史记录管理系统
- 📦 实现多层次智能搜索算法
- 📦 添加数据持久化层
- 📦 完善的TypeScript类型定义

## [0.0.2]

### 修复
- 🐛 **修复恢复功能问题**：现在插件支持完整的恢复功能
  - 改进了精确的撤销功能，不再依赖VS Code的原生撤销
  - 修复了从历史中还原的准确性问题
  - 添加了位置信息记录，使还原更加精确
- 🐛 修复右键菜单缺少还原功能按钮的问题
- 🐛 完善右键菜单功能，现在包含所有还原相关操作

### 新增
- ✨ **历史记录持久化**：重启VS Code后历史记录不会丢失
- ✨ **精确恢复系统**：
  - 支持精确位置还原
  - 智能搜索附近行进行还原
  - 添加唯一ID跟踪每个更改
- ✨ **清除所有历史**：可以一键清除所有撒谎记录
- ✨ **改进的撤销功能**：
  - 支持跨文件撤销提醒
  - 精确的内容匹配和还原
  - 防止误操作的确认机制

### 改进
- 🔧 改进历史记录数据结构，包含更多位置信息
- 🔧 优化还原算法，提高成功率
- 🔧 添加错误处理和用户友好的提示信息

### 计划中
- 字典替换功能：从注释中遍历字典关键字进行替换
- AI驱动的撒谎功能
- 隐藏注释功能

### 修复
- 🐛 修复右键菜单缺少还原功能按钮的问题
- 🐛 完善右键菜单功能，现在包含所有还原相关操作

## [0.0.1] - 2025-05-29

### 新增
- ✨ 手动替换注释功能
- ✨ 选中文本替换注释功能
- ✨ 支持多种编程语言的注释格式
  - JavaScript/TypeScript (`//` 和 `/* */`)
  - Python (`#`)
  - Java/C#/C++ (`//` 和 `/* */`)
  - HTML/XML (`<!-- -->`)
  - CSS/SCSS/Less (`/* */`)
  - Shell/Bash (`#`)
- ✨ 命令面板集成
- ✨ 右键菜单集成
- ✨ 智能注释格式检测
- ✨ 注释格式保持功能

### 功能特点
- 🎯 精确的注释识别和替换
- 🌍 多语言支持
- 🖱️ 友好的用户界面
- ⚡ 实时替换效果
- 😈 成功撒谎提示

### 技术实现
- 基于 VS Code Extension API
- TypeScript 开发
- ESLint 代码规范
- esbuild 构建工具